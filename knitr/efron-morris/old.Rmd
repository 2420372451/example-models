









post_plot;
```

And now we can do the same thing for the population-level replication; because the code's the same, we do not echo it to the output.
```{r comment=NA, echo=FALSE}
df_pop_post <- data.frame(list(dataset = rep("REAL", N),
                               y = y));
for (n in 1:15) {
  df_pop_post <- rbind(df_pop_post,
                       data.frame(list(dataset = rep(paste("repl ", n), N),
                                        y = ss_hier_logit_post$y_pop_rep[n,])));
}
post_pop_plot <-
  ggplot(df_pop_post, aes(y)) +
  facet_wrap(~ dataset) +
  stat_count(width=0.8) +
  scale_x_discrete(limits=c(5, 10, 15, 20)) +
  scale_y_discrete(name="count", limits=c(0, 2, 4)) +
  ggtitle("New Item Replication (Normal Prior on Log Odds)");
post_pop_plot;
```


Now to see how posterior replications look for the model with the hierarchical Beta prior.

```{r comment=NA, echo=FALSE}
file_path <- "hier-post.stan";
lines <- readLines(file_path, encoding="ASCII");
for (n in 1:length(lines)) cat(lines[n],'\n');
```
Now the generated quantities uses the Beta prior for the population replications.

We fit and print values as before.
```{r comment=NA, results='hide'}
fit_hier_post <- stan("hier-post.stan", data=c("N", "K", "y"),
                      control=list(stepsize=0.01, adapt_delta=0.99));
ss_hier_post <- extract(fit_hier_post);
```
We can now print the replicated values <code>y_rep</code> as usual.
```{r comment=NA}
print(fit_hier_post, c("y_rep", "y_pop_rep"), probs=c(0.1, 0.5, 0.9));
```






